(function(){var t,e;e="undefined"!=typeof exports&&null!==exports?exports:this,e.HTTPromiseFormat={json:{headers:{"Content-Type":"application/json",Accept:"application/json"},encode:function(t){var e;try{e=JSON.stringify(t)}catch(r){}return e},parse:function(t){var e;try{e=JSON.parse(t.response)}catch(r){}return{data:e,xhr:t}}},formData:{encode:function(t){var e;return e="string"==typeof t?document.querySelector(t):t,new FormData(e)},parse:function(t){return{data:t.response,xhr:t}}}},e.HTTPromise=function(){function e(t){var e;null==t&&(t={}),this.config=t,(e=this.config).type||(e.type="json")}return e.prototype.get=function(t,e){var r,n,o,s;if(e){n=[];for(r in e)s=e[r],n.push(r+"="+s);o="?"+n.join("&"),t=encodeURI(t+o)}return this.request("get",t)},e.prototype.post=function(t,e){return this.request("post",t,e)},e.prototype.put=function(t,e){return this.request("put",t,e)},e.prototype.patch=function(t,e){return this.request("patch",t,e)},e.prototype["delete"]=function(t,e){return this.request("delete",t,e)},e.prototype.request=function(e,r,n){return new t(this.config,e,r,n)},e}(),t=function(){function t(t,r,n,o){var s;if(s=e.HTTPromiseFormat[t.type],null!=t.headers&&"object"!=typeof t.headers)throw new TypeError("If given, headers must an object where each key value pair represents a request header");this.promise=new Promise(function(e,i){var u,a,h,p,c;p=new XMLHttpRequest,p.onload=function(){return e(s.parse(this))},p.onerror=function(){return i({state:"ERROR",xhr:this})},p.onabort=function(){return i({state:"ABORT",xhr:this})},p.ontimeout=function(){return i({state:"TIMEOUT",xhr:this})},p.open(r.toUpperCase(),n,!0),a=s.headers;for(u in a)c=a[u],p.setRequestHeader(u,c);if(t.headers){h=t.headers;for(u in h)c=h[u],p.setRequestHeader(u,c)}return o?p.send(s.encode(o)):p.send()})}return t.prototype.then=function(t){return this.promise.then(function(e){return t(e.data,e.xhr)}),this},t.prototype.when=function(t,e){return this.promise.then(function(r){return r.xhr.status===t?e(r.data,r.xhr):void 0}),this},t.prototype.success=function(t){return this.promise.then(function(e){return e.xhr.status>=200&&e.xhr.status<300?t(e.data,e.xhr):void 0}),this},t.prototype.error=function(t){var e,r;return e=function(e){return e.xhr.status<200||e.xhr.status>=300?t(e.data,e.xhr):void 0},r=function(e){return t(e.data,e.xhr)},this.promise.then(e,r),this},t}()}).call(this);
